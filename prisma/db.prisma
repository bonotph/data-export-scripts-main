generator client {
  provider = "prisma-client-js"
  output   = "./generated/db_client"
}

datasource db {
  provider = "postgresql"
  url      = env("DB_PSQL_URL")
}

model cf_enrollment_statistics {
  create_at            DateTime             @default(now()) @db.Timestamptz(6)
  workspace_id         Int
  status_id            Int
  count                Int
  cf_enrollment_status cf_enrollment_status @relation(fields: [status_id], references: [id])
  cf_workspace         cf_workspace         @relation(fields: [workspace_id], references: [id])

  @@id([create_at, workspace_id, status_id])
}

model cf_enrollment_status {
  id                       Int                        @id @default(autoincrement())
  status                   String                     @unique @db.VarChar(100)
  cf_enrollment_statistics cf_enrollment_statistics[]
}

model cf_workspace {
  id                       Int                        @id @default(autoincrement())
  name                     String                     @unique @db.VarChar(10)
  specimen_prefix          String?                    @db.VarChar(2)
  is_cohort                Boolean                    @default(false)
  cf_enrollment_statistics cf_enrollment_statistics[]
}

model dig_backup_file {
  id        String  @id
  name      String
  size      BigInt?
  job_name  String
  job_id    String
  workspace String
  project   String
}

model s3_fastq_file {
  file_key      String   @id @unique
  last_modified DateTime @db.Timestamptz(6)
  size          BigInt
}

model varapp_family {
  mtime                DateTime              @db.Timestamptz(6)
  file_name            String                @id @unique
  sample_ids           String[]
  entry_created_at     DateTime              @default(now()) @db.Timestamptz(6)
  entry_deleted_at     DateTime?             @db.Timestamptz(6)
  entry_is_deleted     Boolean               @default(false)
  entry_updated_at     DateTime              @default(now()) @db.Timestamptz(6)
  varapp_family_ignore varapp_family_ignore?
}

model varapp_family_ignore {
  varapp_file_name String        @unique
  created_at       DateTime      @default(now()) @db.Timestamptz(6)
  varapp_family    varapp_family @relation(fields: [varapp_file_name], references: [file_name])
}

model dig_job {
  id               String    @id
  name             String
  status           Int       @db.SmallInt
  priority         Int       @db.SmallInt
  queue_id         String
  nodes_status     Json?     @db.Json
  created_at       DateTime  @db.Timestamptz(6)
  started_at       DateTime? @db.Timestamptz(6)
  stopped_at       DateTime? @db.Timestamptz(6)
  project          String
  workspace        String
  pipeline_name    String
  pipeline_version String
}

model s3_aws_processed_output_file {
  file_key      String   @id
  last_modified DateTime @db.Timestamptz(6)
  size          BigInt
}

model s3_fastq_folder_ignore {
  folder String @unique
}

model sample_batch {
  s3_folder String   @id
  batch     String[]
}
